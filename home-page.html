<!DOCTYPE html>
<html>
    <head>
        <title>SafeSpace Home</title>
        <link rel="stylesheet" href="styles.css">
    </head>
    <body>
        <main>
            <nav>
                <p>SafeSpace</p>
                <ul>
                    <li><a href="home-page.html"><i class="fas fa-home" id="home" title="Back to Home"></i></a></li>
                    <li><i class="fas fa-cog" id="settings" title="User Settings"></i></li>
                    <li><i class="fas fa-hands-helping" id="community" title="Community Resources"></i></li>
                    <li><a href="index.html"><i class="fas fa-power-off" id="logout" title="Logout"></i></a></li>
                </ul>
            </nav>

            <section id="make-post">
                <div id="avatar-img-top">
                    <div class="dot">
                        <img src="images/animals.png" alt="squirrel avatar" width="90px">
                    </div>
                </div>
                <p>Welcome back <b>Anonymous Squirrel</b></p>
                <button id="make-post-button" onclick="showPostModal()"><i class="fas fa-plus"></i> Make a Post</button>
            </section>

            <section id="post-modal">
                <div id="post-modal-content">
                    <!-- modal close button  -->
                    <button id="close" onclick="hideModal()" title="Close">&times;</button>
                    
                    <div id="post-modal-avatar">
                        <div class="post-modal-avatar">
                            <img src="images/animals.png" alt="squirrel avatar" width="50px" id="modal-avatar-img">
                        </div>
                        <p id="username">Anonymous Squirrel</p>
                    </div>
                    <textarea id="make-post-textarea" cols="30" rows="10" placeholder="Feel free to talk, this is a safe space..."></textarea>
                    <button id="post" onclick="makePost()">Post</button>
                </div>
            </section>

            <div id = "all-posts">

                <section id="pseudo-post-1">
                    <section id="pseudo-post">
                        <div id="post-top">
                            <div><img src="images/animals.png" alt="squirrel avatar" id="avatar-img" width="50px"></div>
                            <div id="name-date">
                                <h3>Anonymous Squirrel</h3>
                                <div><time datetime="2021-10-14 02:39">Oct 14, 2021</time></div>
                            </div>
                            <p id="info-button"><i class="fas fa-info-circle"></i></p>
                            <p id="delete-post"><i class="fas fa-times-circle" id="delete-post" title="Delete" onclick="deletePost()"></i></p>
                        </div>

                        <div id="post-content-container">
                            <hr>
                            <p id="post-content">"post content"</p>
                            <hr>
                        </div>
                
                        <div id="post-info">
                            <p><i class="fas fa-comments" id="comments" title="Comment"></i> 0 comments</p>
                            <p><i class="fas fa-thumbs-up" title="Upvote Post" onclick="upvote()"></i> 0 upvotes</p>
                            <p><i class="fas fa-thumbs-down" title="Downvote Post"></i> 0 downvotes</p>
                        </div>
                    </section>

                    <hr id="post-separator">
                </section>

                <section class="pseudo-post-2">
                    <section id="pseudo-post">
                        <div id="post-top">
                            <div><img src="images/food.png" alt="food avatar" id="avatar-img" width="50px"></div>
                            <div id="name-date">
                                <h3>Anonymous Hamburger</h3>
                                <div><time datetime="2021-10-11 02:39">Oct 11, 2021</time></div>
                            </div>
                            <p id="info-button"><i class="fas fa-info-circle"></i></p>
                            <p id="delete-post"><i class="fas fa-times-circle" id="delete-post" title="Delete" onclick="deletePost()"></i></p>
                        </div>

                        <div id="post-content-container">
                            <hr>
                            <p id="post-content">"post content"</p>
                            <hr>
                        </div>
                
                        <div id="post-info">
                            <p><i class="fas fa-comments" id="comments" title="Comment"></i> 0 comments</p>
                            <p><i class="fas fa-thumbs-up" title="Upvote Post"></i> 0 upvotes</p>
                            <p><i class="fas fa-thumbs-down" title="Downvote Post"></i> 0 downvotes</p>
                        </div>
                    </section>

                    <hr id="post-separator">
                </section>
            </div>
            

<!-- ———————————————Markup for modal background fade—————————————————————————————————————————————————————————— -->
            <div id="overlay"></div>

        </main>

        <script src="https://kit.fontawesome.com/7533af764e.js" crossorigin="anonymous"></script>
        <script>
            let globalcount = 0;

            function showPostModal(e) {
                const makePost = document.getElementById('post-modal')
                const dimmer = document.getElementById('overlay')
                makePost.style.display = 'block'
                // console.log('beep')
                dimmer.style.display = 'block'
            }

            function hideModal(e) {
                const makePost = document.getElementById('post-modal')
                const dimmer = document.getElementById('overlay')
                makePost.style.display = 'none'
                // console.log('beep')
                dimmer.style.display = 'none'
            }

            function newDate() {
                const d = new Date();
                const day = d.getDate()
                const months = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"];
                const newMonth = months[d.getMonth()]
                const year = d.getFullYear()
                const fullDate = `${newMonth} ${day}, ${year}`
                // console.log(fullDate)
                return fullDate
            }



            function addImg() {
                const newImg = document.createElement('img')
                const avatarImg = document.getElementById('modal-avatar-img').src
                newImg.src = avatarImg
                console.log(avatarImg)
                return newImg
            }



            function postTop() {
                // create post-top div element
                const postTop = document.createElement('div');
                postTop.setAttribute('id', 'post-top');

                // create img container div element and append
                const imgContainer = document.createElement('div');
                postTop.appendChild(imgContainer);
                const newImg = addImg();
                newImg.setAttribute('id', 'avatar-img')
                newImg.style.width = '50px'
                imgContainer.appendChild(newImg);


                // create name and date 
                const nameAndDate = document.createElement('div');
                nameAndDate.setAttribute('id', 'name-date');
                postTop.appendChild(nameAndDate);

                const usernameDisplay = document.createElement('h3');
                usernameDisplay.setAttribute('id', 'post-username');
                const username = document.getElementById('username').textContent
                usernameDisplay.innerHTML = username;
                nameAndDate.appendChild(usernameDisplay);

                const dateDisplay = document.createElement('div');
                dateDisplay.setAttribute('id', 'date');
                const d = newDate();
                dateDisplay.innerHTML = d;
                nameAndDate.appendChild(dateDisplay);

                // create info button
                const infoButton = document.createElement('p');
                infoButton.setAttribute('id', 'info-button');
                postTop.appendChild(infoButton);
                const infoIcon = document.createElement('i');
                infoIcon.setAttribute('class', 'fas fa-info-circle');
                infoButton.appendChild(infoIcon);

                // create delete button
                const deleteButton = document.createElement('p')
                deleteButton.setAttribute('id', 'delete-button')
                postTop.appendChild(deleteButton);
                const deleteIcon = document.createElement('i');
                deleteIcon.setAttribute('class', 'fas fa-times-circle')
                deleteIcon.setAttribute('id', 'delete-post');
                deleteIcon.setAttribute('onclick', 'deletePost()');
                deleteButton.appendChild(deleteIcon);

                return postTop;
            }

            function content() {
                const contentContainer = document.createElement('div');
                contentContainer.setAttribute('id', 'post-content-container');

                const line1 = document.createElement('hr');
                contentContainer.appendChild(line1);

                const content = document.createElement('div');
                content.setAttribute('id', 'post-content');
                const textInput = document.getElementById('make-post-textarea').value;
                content.innerHTML = textInput
                contentContainer.appendChild(content);

                const line2 = document.createElement('hr');
                contentContainer.appendChild(line2);

                return contentContainer;
            }

            function postInfo() {
                const postInfo = document.createElement('div');
                postInfo.setAttribute('id', 'post-info')

                const comments = document.createElement('p');
                comments.innerHTML = ' 0 Comments';
                const commentIcon = document.createElement('i');
                commentIcon.setAttribute('class', 'fas fa-comments');
                comments.insertBefore(commentIcon, comments.firstChild);
                postInfo.appendChild(comments);

                const upvote = document.createElement('p');
                upvote.innerHTML = ' 0 Upvotes';
                const upvoteIcon = document.createElement('i');
                upvoteIcon.setAttribute('class', 'fas fa-thumbs-up');
                upvote.insertBefore(upvoteIcon, upvote.firstChild);
                postInfo.appendChild(upvote);

                const downvote = document.createElement('p');
                downvote.innerHTML = ' 0 Downvotes';
                const downvoteIcon = document.createElement('i');
                downvoteIcon.setAttribute('class', 'fas fa-thumbs-down');
                downvote.insertBefore(downvoteIcon, downvote.firstChild);
                postInfo.appendChild(downvote);

                return postInfo;
            }

            function newPost() {
                const postsContainer = document.createElement('div');
                postsContainer.setAttribute('id', 'posts-container' + globalcount++);
                const post = document.createElement('section')
                post.setAttribute('id', 'pseudo-post');
                postsContainer.appendChild(post);
                const line = document.createElement('hr');
                line.setAttribute('id', 'post-separator');
                postsContainer.appendChild(line);
                // const pseudoPost = document.getElementById('new-pseudo-post');

                const postTopContent = postTop();
                const postContent = content();
                const info = postInfo();
                // const newContent = displayContent()

                post.appendChild(postTopContent);
                post.appendChild(postContent);
                post.appendChild(info);

                return postsContainer
            }

            function makePost(e) {
                const allPosts = document.getElementById('all-posts')
                const post = newPost()

                allPosts.insertBefore(post, allPosts.firstChild)

                document.getElementById('make-post-textarea').value = "";
                hideModal()
            }

            function deletePost(e) {
                const deleteIcon = event.target;
                const deleteIconParent = deleteIcon.parentElement
                const deleteIconGrandparent = deleteIconParent.parentElement.parentElement.parentElement
                console.log(deleteIconGrandparent)

                deleteIconGrandparent.remove();
            }

            function upvote(e) {
                console.log('im dying')
            }
        </script>
    </body>
</html>